#!/bin/sh

# **
# clean orphans and other cache stuff
# *

# *****************************************************************************
# main
# *****************************************************************************

# arch-based
if [ -x "$(command -v "pacman")" ]; then
    # display cached packages
    printf "amount of cached packages: %s | size: %s\n" \
        "$(sudo ls /var/cache/pacman/pkg | wc -l)" \
        "$(sudo du -hs /var/cache/pacman/pkg)"

    # clear ~/.cache folder
    rm -fr "$HOME"/.cache/

    # clear pkg cache
    sudo pacman -Scc
    sudo paccache -r

    # clear orphans
    sudo pacman -Rns --noconfirm $(pacman -Qdqt)

    # display cached packages after
    printf "amount of cached packages: %s | size: %s\n" \
        "$(sudo ls /var/cache/pacman/pkg | wc -l)" \
        "$(sudo du -hs /var/cache/pacman/pkg)"

    # void
elif [ -x "$(command -v "xbps-install")" ]; then
    # display cached packages
    printf "amount of cached packages: %s | size: %s\n" \
        "$(sudo ls /var/cache/xbps | wc -l)" "$(sudo du -hs /var/cache/xbps)"

    # clear ~/.cache folder
    rm -fr "$HOME"/.cache/

    # clear pkg cache
    sudo xbps-remove -Ofoy
    # clear old kernels
    sudo vkpurge rm all

    # display cached packages after
    printf "amount of cached packages: %s | size: %s\n" \
        "$(sudo ls /var/cache/xbps | wc -l)" "$(sudo du -hs /var/cache/xbps)"
fi
