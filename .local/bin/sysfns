#!/bin/bash

# **
# dmenu dropdown with some system options
# *

# *****************************************************************************
# preamble
# *****************************************************************************
# source utility functions
. ./utils

# check if running with elevated privileges
check_su

# *****************************************************************************
# main
# *****************************************************************************
declare opts=("reboot
sleep
shutdown
end-x-session")

# non-systemd init systems (OpenRC missing)
case "$(readlink -f /sbin/init)" in
*runit*)
    zzz="zzz"
    sdn="poweroff"
    ;;
esac

CHOICE=$(printf '%s' "${opts[@]}" | dmenu -c -i -l 20 -bw 6 -fn "Overpass Mono" -p 'command: ')

case "$CHOICE" in
reboot)
    ${reb:-reboot}
    ;;
sleep)
    ${zzz:-systemctl suspend-then-hibernate}
    ;;
shutdown)
    ${sdn:-shutdown -h now}
    ;;
end-x-session)
    pkill -15 Xorg
    ;;
esac
