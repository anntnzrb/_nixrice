#!/bin/sh

# gets the current battery capacity
#
# only tested with one battery attached

# loop through all batteries
for battery in /sys/class/power_supply/BAT?; do
    capacity=$(cat "$battery"/capacity)
    status=$(cat "$battery"/status)

    if [ "$status" = "Discharging" ] || [ "$status" = "Charging" ] ||
        [ "$status" = "Unknown" ]; then
        # pick icon depending on the amount of battery
        if [ "$capacity" -ge 80 ]; then
            icon="ï‰€ "
        elif [ "$capacity" -ge 60 ]; then
            icon="ï‰ "
        elif [ "$capacity" -ge 30 ]; then
            icon="ï‰‚ "
        elif [ "$capacity" -ge 15 ]; then
            icon="ï‰ƒ "
        elif [ "$capacity" -lt 15 ]; then
            icon="ï‰„ "
        fi
        # if charging, plug icon + %
        [ "$status" = "Charging" ] && icon="ğŸ”Œ"

        printf '%s%%' "$icon $capacity"
    else
        icon="ğŸ”Œ"
        printf '%s' "ğŸŸ¢$icon"
    fi

done
