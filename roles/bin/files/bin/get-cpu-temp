#!/bin/sh

# get-cpu-temp --- Retrieve CPU temperature info

# Code:

# shellcheck disable=SC2006,SC2312

thermal_dir='/sys/class/thermal'
thermal_devices="${thermal_dir}/thermal_zone*"

# loop through thermal devices
for dev in ${thermal_devices}; do
    read -r type < "${dev}/type"
    read -r temp < "${dev}/temp"

    # REVIEW: discard other devices
    test "${type}" != 'x86_pkg_temp' && continue

    temp=`printf '%s' "${temp}" | cut -c1-2`

    # shellcheck disable=2086
    # integer comparison
    if   test ${temp} -ge 80; then icon=''
    elif test ${temp} -ge 60; then icon=''
    elif test ${temp} -ge 40; then icon=''
    elif test ${temp} -ge 30; then icon=''
    elif test ${temp} -lt 25; then icon=''
    fi

    printf '%s %s°C\n' "${icon}" "${temp}"
done

exit 0
