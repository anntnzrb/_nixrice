#!/bin/sh

# get-weather --- Retrieves formatted weather info

# Commentary:

# ${location} obtains current location programatically.

# Code:

# shellcheck disable=SC2006,SC2312

# do nothing if no net
! ping -q -c 1 'example.com' >/dev/null 2>&1 \
    && printf '📡❌\n' >&2 && exit 1

# set-up location
location=`curl -Sfs 'ifconfig.co/city'`

# get weather status
weather=`curl -Sfs "https://wttr.in/${location}?format=%c+%t" | tr -d '[:space:]'`

# check if retrieved weather is valid
printf '%s' "${weather}" | grep -q 'known' && printf '☀ N/A\n' && exit 1

printf '%s\n' "${weather}"

exit 0
