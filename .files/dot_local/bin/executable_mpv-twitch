#!/bin/sh

# mpv-twitch --- Twitch Player via mpv + Chatterino

# Commentary:

# Simple wrapper around 'streamlink' (uses 'mpv') and 'Chatterino'.
# Check 'streamlink' settings, e.g: ~/.config/streamlink/

# Code:

# do nothing if no net or no dependencies
! internetp && err 'No active network connection, quitting...' && exit 1
installedp 'streamlink' \
    || { err "Dependency 'streamlink' not found" && exit 1; }

# launch player
setsid -f streamlink --url "https://twitch.tv/${1}"

# launch chat
! installedp 'chatterino' \
    && printf "Chatterino is not installed, not launching chat...\n" && exit 0
setsid -f chatterino --channels "t:${1}"
