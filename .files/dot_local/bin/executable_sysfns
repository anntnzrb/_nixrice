#!/bin/sh

# **
# dmenu dropdown with some system options
#
# systemd commands by default
# *

# check if running with elevated priviledges; elevate if not
! rootp && err 'This script needs root priviledges' && exit 1

# init systems
case "$(readlink -f '/sbin/init')" in
*runit*)
    zzz='zzz'
    reb='reboot'
    sdn='poweroff'
    ;;
*openrc*) # untested
    zzz='hibernate'
    reb='openrc-shutdown -r'
    sdn='openrc-shutdown -p'
    ;;
*systemd*)
    zzz='systemctl suspend'
    reb='systemctl reboot'
    sdn='systemctl suspend'
    ;;
*) err 'No option set for this system' && exit 1 ;;
esac

# list of options
opts='reboot sleep shutdown kill-x'

# menu
# shellcheck disable=2086
case "$(printf "%s\n" ${opts} | dmenu -c -i -l 20 -bw 6 -p 'command: ')" in
reboot)
    ${reb}
    ;;

sleep)
    ${zzz}
    ;;

shutdown)
    ${sdn}
    ;;

kill-x)
    pkill -15 'X'
    ;;
*) ;;
esac
